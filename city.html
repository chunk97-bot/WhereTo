<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Details - WhereTo | Travel Guide</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Complete travel guide with attractions, tips, budget information, and best time to visit.">
    <meta name="robots" content="index, follow">
    
    <link rel="icon" type="image/png" href="favicon.png">
    <meta name="theme-color" content="#0f0f23">
    
    <link rel="stylesheet" href="style.css?v=2">
    <link rel="stylesheet" href="pages.css?v=4">
    
    <!-- Leaflet CSS for Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@600;700;800&family=Righteous&display=swap" rel="stylesheet">
    
    <style>
        /* City Detail Specific Styles - Matching destination-detail.html */
        .detail-hero {
            position: relative;
            height: 50vh;
            min-height: 350px;
            max-height: 500px;
            background-size: cover;
            background-position: center;
        }

        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, 
                rgba(15, 15, 35, 0.3) 0%, 
                rgba(15, 15, 35, 0.5) 50%,
                rgba(15, 15, 35, 0.95) 100%);
        }

        .hero-content {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .breadcrumb {
            display: flex;
            gap: 0.5rem;
            font-size: 0.85rem;
            margin-bottom: 1rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .breadcrumb a {
            color: #00d4ff;
            text-decoration: none;
        }

        .dest-title {
            font-family: 'Poppins', sans-serif;
            font-size: 3rem;
            margin-bottom: 0.5rem;
            background: linear-gradient(135deg, #fff 0%, #00d4ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .dest-subtitle {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            align-items: center;
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .dest-location {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .detail-main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 2rem;
        }

        .detail-content {
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .detail-sidebar {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        /* Info Cards */
        .info-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .info-card h3 {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Quick Info */
        .quick-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .info-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.5);
            text-transform: uppercase;
        }

        .info-value {
            font-size: 1rem;
            font-weight: 600;
            color: #00d4ff;
        }

        /* Description */
        .description-text {
            line-height: 1.8;
            color: rgba(255, 255, 255, 0.8);
        }

        /* Budget Section */
        .budget-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
        }

        .budget-item {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .budget-item.budget {
            border-color: rgba(34, 197, 94, 0.3);
        }

        .budget-item.mid {
            border-color: rgba(251, 191, 36, 0.3);
        }

        .budget-item.luxury {
            border-color: rgba(168, 85, 247, 0.3);
        }

        .budget-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 0.25rem;
        }

        .budget-value {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .budget-item.budget .budget-value { color: #22c55e; }
        .budget-item.mid .budget-value { color: #fbbf24; }
        .budget-item.luxury .budget-value { color: #a855f7; }

        /* Highlights */
        .highlights-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .highlight-item {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-size: 0.85rem;
            color: #00d4ff;
        }

        /* CTA Card */
        .cta-card {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%);
            border: 1px solid rgba(0, 212, 255, 0.3);
        }

        .cta-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, #00d4ff 0%, #8b5cf6 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .nova-btn-icon {
            width: 24px;
            height: 24px;
            flex-shrink: 0;
        }

        .trip-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .trip-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 107, 107, 0.4);
        }

        .trip-btn.saved {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .trip-btn.saved:hover {
            box-shadow: 0 5px 20px rgba(16, 185, 129, 0.4);
        }

        /* Toast notification */
        .trip-toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 10000;
            opacity: 0;
            transition: all 0.3s ease;
        }

        .trip-toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .trip-toast a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            transition: background 0.2s;
        }

        .trip-toast a:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .cta-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0, 212, 255, 0.4);
        }

        /* Attractions Accordion */
        .attractions-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .attraction-accordion {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .attraction-accordion:hover {
            border-color: rgba(0, 212, 255, 0.3);
        }

        .attraction-accordion.expanded {
            border-color: rgba(0, 212, 255, 0.5);
            background: rgba(255, 255, 255, 0.08);
        }

        .attraction-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1rem 1.25rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .attraction-header:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .attraction-header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .attraction-icon {
            font-size: 1.5rem;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 212, 255, 0.15);
            border-radius: 10px;
        }

        .attraction-title {
            font-size: 1rem;
            font-weight: 500;
            color: #fff;
        }

        .attraction-type {
            font-size: 0.75rem;
            color: #00d4ff;
            background: rgba(0, 212, 255, 0.15);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            white-space: nowrap;
            margin-right: 1rem;
        }

        .attraction-toggle {
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.6);
            transition: transform 0.3s ease;
        }

        .attraction-accordion.expanded .attraction-toggle {
            transform: rotate(180deg);
            color: #00d4ff;
        }

        .attraction-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .attraction-accordion.expanded .attraction-content {
            max-height: 200px;
        }

        .attraction-details {
            padding: 0 1.25rem 1.25rem 1.25rem;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.6;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 1rem;
        }

        /* Tips Section */
        .tips-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .tip-item {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 1rem 1.25rem;
            background: linear-gradient(145deg, rgba(0, 212, 255, 0.08), rgba(139, 92, 246, 0.08));
            border-left: 3px solid #00d4ff;
            border-radius: 0 12px 12px 0;
        }

        .tip-item::before {
            content: "üí°";
            font-size: 1rem;
        }

        .tip-item p {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.5;
            margin: 0;
        }

        /* Country Info */
        .country-flag {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .country-details {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .country-detail {
            display: flex;
            justify-content: space-between;
            font-size: 0.85rem;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .country-detail:last-child {
            border-bottom: none;
        }

        .country-detail span:first-child {
            color: rgba(255, 255, 255, 0.6);
        }

        /* Best Months */
        .months-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
        }

        .month-tag {
            text-align: center;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            font-size: 0.75rem;
        }

        .month-tag.best {
            background: rgba(34, 197, 94, 0.2);
            color: #22c55e;
        }

        /* City Map Section */
        .city-map-section {
            margin-top: 2rem;
        }

        .map-container {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .map-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .map-header h3 {
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin: 0;
        }

        .map-actions {
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .map-btn {
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            border: 1px solid rgba(0, 212, 255, 0.4);
            background: rgba(0, 212, 255, 0.1);
            color: #00d4ff;
            font-size: 0.85rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .map-btn:hover {
            background: rgba(0, 212, 255, 0.25);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 212, 255, 0.2);
        }

        #cityMap {
            width: 100%;
            height: 400px;
            border-radius: 16px;
            z-index: 1;
            background: #1a1a2e;
        }

        .map-legend {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        .legend-title {
            font-size: 0.85rem;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .legend-items {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.8);
            background: rgba(255, 255, 255, 0.05);
            padding: 0.4rem 0.75rem;
            border-radius: 20px;
        }

        .legend-icon {
            font-size: 1rem;
        }

        /* Custom Leaflet marker styling */
        .custom-marker {
            background: linear-gradient(135deg, #00d4ff 0%, #8b5cf6 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.4);
            border: 2px solid white;
            width: 36px;
            height: 36px;
        }

        .custom-div-icon {
            background: transparent !important;
            border: none !important;
        }

        .leaflet-container {
            background: #e5e3df;
        }

        .marker-popup {
            text-align: center;
        }

        .marker-popup h4 {
            margin: 0 0 0.25rem 0;
            font-size: 0.95rem;
            color: #1a1a2e;
        }

        .marker-popup .popup-type {
            font-size: 0.75rem;
            color: #666;
            text-transform: capitalize;
        }

        .city-center-marker {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%);
        }

        /* Leaflet popup customization */
        .leaflet-popup-content-wrapper {
            background: white;
            border-radius: 12px;
            box-shadow: 0 3px 14px rgba(0, 0, 0, 0.15);
        }

        .leaflet-popup-content {
            margin: 0.75rem 1rem;
        }

        .leaflet-popup-tip {
            background: white;
        }

        /* Map loading state */
        .map-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 400px;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            color: rgba(255, 255, 255, 0.6);
        }

        .map-loading .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(0, 212, 255, 0.2);
            border-top-color: #00d4ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Back Button */
        .back-btn {
            position: absolute;
            top: 80px;
            left: 2rem;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            padding: 0.75rem 1.5rem;
            border-radius: 25px;
            color: white;
            text-decoration: none;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(0, 212, 255, 0.3);
        }

        /* Responsive */
        @media (max-width: 992px) {
            .detail-main {
                grid-template-columns: 1fr;
            }

            .detail-sidebar {
                order: -1;
            }
        }

        @media (max-width: 768px) {
            .dest-title {
                font-size: 2rem;
            }

            .detail-hero {
                height: 40vh;
            }

            .detail-main {
                padding: 1rem;
            }

            .quick-info {
                grid-template-columns: 1fr;
            }

            .months-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .budget-grid {
                grid-template-columns: 1fr;
            }

            #cityMap {
                height: 300px;
            }

            .map-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .map-actions {
                width: 100%;
            }

            .map-btn {
                flex: 1;
                justify-content: center;
            }
        }

        @media (max-width: 480px) {
            .dest-title {
                font-size: 1.75rem;
            }

            .dest-subtitle {
                flex-direction: column;
                gap: 0.5rem;
                align-items: flex-start;
            }

            .back-btn {
                top: 70px;
                left: 1rem;
                padding: 0.5rem 1rem;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="page-container">
        <!-- Navigation -->
        <nav class="main-nav">
            <div class="nav-brand">
                <a href="home.html">
                    <svg viewBox="0 0 200 50" class="nav-logo-svg">
                        <text x="5" y="35" class="nav-brand-text">WhereTo</text>
                        <circle cx="175" cy="28" r="6" fill="#ff6b6b" class="nav-pin-dot"/>
                        <circle cx="175" cy="27" r="2.5" fill="white"/>
                        <g class="nav-flying-plane">
                            <path d="M0 0 L-6 -2 L-5 0 L-6 2 Z" fill="#008cff"/>
                            <path d="M-3 -4 L-1.5 0 L-3 4 L-4 0 Z" fill="#008cff" opacity="0.7"/>
                        </g>
                        <path class="nav-plane-trail" d="M100 38 Q130 25 150 30 Q170 35 180 22" 
                              fill="none" stroke="rgba(0,140,255,0.3)" stroke-width="1.5" 
                              stroke-dasharray="4 3" stroke-linecap="round"/>
                    </svg>
                </a>
            </div>
            <div class="nav-links">
                <a href="home.html" class="nav-link">üè† Home</a>
                <a href="nova.html" class="nav-link"><svg class="nav-robot-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="robotHead3" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#00f5ff"/><stop offset="50%" style="stop-color:#8b5cf6"/><stop offset="100%" style="stop-color:#ec4899"/></linearGradient><linearGradient id="robotGlow3" x1="0%" y1="0%" x2="0%" y2="100%"><stop offset="0%" style="stop-color:#fff;stop-opacity:0.8"/><stop offset="100%" style="stop-color:#fff;stop-opacity:0"/></linearGradient><filter id="neonGlow3"><feGaussianBlur stdDeviation="0.5" result="blur"/><feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge></filter></defs><rect x="4" y="7" width="16" height="13" rx="4" fill="url(#robotHead3)" filter="url(#neonGlow3)"/><rect x="5" y="8" width="14" height="4" rx="2" fill="url(#robotGlow3)" opacity="0.4"/><rect x="7" y="3" width="10" height="5" rx="2.5" fill="url(#robotHead3)"/><circle cx="8.5" cy="12.5" r="2.5" fill="#0a0a1a"/><circle cx="15.5" cy="12.5" r="2.5" fill="#0a0a1a"/><circle cx="8.5" cy="12.5" r="1.5" fill="#00f5ff"/><circle cx="15.5" cy="12.5" r="1.5" fill="#00f5ff"/><rect x="10" y="16" width="4" height="2" rx="1" fill="#ec4899"/><rect x="11" y="0" width="2" height="4" rx="1" fill="url(#robotHead3)"/><circle cx="12" cy="0" r="1.5" fill="#00f5ff"><animate attributeName="r" values="1.5;2;1.5" dur="1.5s" repeatCount="indefinite"/></circle><rect x="1" y="10" width="3" height="6" rx="1.5" fill="url(#robotHead3)"/><rect x="20" y="10" width="3" height="6" rx="1.5" fill="url(#robotHead3)"/></svg> NOVA</a>
                <a href="destinations.html" class="nav-link active">üåç Destinations</a>
                <a href="trip-planner.html" class="nav-link">üóìÔ∏è Trip Planner</a>
                <a href="visa-guide.html" class="nav-link"><svg class="nav-visa-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 5L20 2V20L4 23Z" fill="#4a90c2"/><path d="M4 5L20 2L21 3L5 6Z" fill="#7fc4e8"/><path d="M20 2L21 3V21L20 20Z" fill="#2d5a87"/><circle cx="12" cy="11" r="4" stroke="#fff" stroke-width="1.2" fill="none"/><line x1="9" y1="14" x2="15" y2="8" stroke="#fff" stroke-width="1.2"/><rect x="7" y="17" width="8" height="1" fill="#fff" opacity="0.6"/></svg> Visa Guide</a>
                <a href="budget-calculator.html" class="nav-link">üí∞ Budget</a>
                <a href="currency-converter.html" class="nav-link">üí± Currency</a>
            </div>
            <button class="nav-toggle" id="navToggle">‚ò∞</button>
        </nav>

        <!-- Hero Section -->
        <section class="detail-hero" id="heroSection">
            <div class="hero-overlay"></div>
            <a href="#" class="back-btn" id="backBtn">‚Üê Back to Country</a>
            <div class="hero-content">
                <div class="breadcrumb">
                    <a href="destinations.html">Destinations</a>
                    <span>‚Ä∫</span>
                    <a href="#" id="regionLink">Region</a>
                    <span>‚Ä∫</span>
                    <a href="#" id="countryLink">Country</a>
                    <span>‚Ä∫</span>
                    <span id="cityBreadcrumb">City</span>
                </div>
                <h1 class="dest-title" id="cityTitle">Loading...</h1>
                <div class="dest-subtitle">
                    <span class="dest-location" id="cityLocation">üìç Loading...</span>
                    <span id="cityPopulation">üë• --</span>
                </div>
            </div>
        </section>

        <!-- Main Content -->
        <main class="detail-main">
            <div class="detail-content">
                <!-- Description -->
                <div class="info-card">
                    <h3>üìù About This City</h3>
                    <p class="description-text" id="cityDescription">Loading description...</p>
                </div>

                <!-- Budget Breakdown -->
                <div class="info-card">
                    <h3>üí∞ Daily Budget Guide</h3>
                    <div class="budget-grid">
                        <div class="budget-item budget">
                            <div class="budget-label">Budget</div>
                            <div class="budget-value" id="budgetLow">$--</div>
                        </div>
                        <div class="budget-item mid">
                            <div class="budget-label">Mid-Range</div>
                            <div class="budget-value" id="budgetMid">$--</div>
                        </div>
                        <div class="budget-item luxury">
                            <div class="budget-label">Luxury</div>
                            <div class="budget-value" id="budgetLuxury">$--</div>
                        </div>
                    </div>
                </div>

                <!-- Attractions -->
                <div class="info-card">
                    <h3>üèõÔ∏è Top Attractions</h3>
                    <div class="attractions-list" id="attractionsList">
                        <!-- Loaded dynamically -->
                    </div>
                </div>

                <!-- Travel Tips -->
                <div class="info-card">
                    <h3>üí° Travel Tips</h3>
                    <div class="tips-list" id="tipsList">
                        <!-- Loaded dynamically -->
                    </div>
                </div>

                <!-- City Map Section -->
                <div class="city-map-section" id="cityMapSection">
                    <div class="map-container">
                        <div class="map-header">
                            <h3>üó∫Ô∏è <span id="mapTitle">City Map</span></h3>
                            <div class="map-actions">
                                <button class="map-btn" onclick="resetMapView()" title="Reset view">
                                    üéØ Center
                                </button>
                                <button class="map-btn" onclick="toggleLandmarks()" id="toggleLandmarksBtn" title="Toggle landmarks">
                                    üìç Landmarks
                                </button>
                            </div>
                        </div>
                        <div id="cityMap">
                            <div class="map-loading">
                                <div class="spinner"></div>
                                <span>Loading map...</span>
                            </div>
                        </div>
                        <div class="map-legend" id="mapLegend">
                            <div class="legend-title">Map Legend</div>
                            <div class="legend-items" id="legendItems">
                                <!-- Populated dynamically -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="detail-sidebar">
                <!-- Ask NOVA Card -->
                <div class="info-card cta-card">
                    <button class="cta-btn" onclick="askNova()">
                        <svg class="nova-btn-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="novaBtnGrad" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" style="stop-color:#00f5ff"/><stop offset="50%" style="stop-color:#8b5cf6"/><stop offset="100%" style="stop-color:#ec4899"/></linearGradient></defs><rect x="4" y="7" width="16" height="13" rx="4" fill="url(#novaBtnGrad)"/><rect x="7" y="3" width="10" height="5" rx="2.5" fill="url(#novaBtnGrad)"/><circle cx="8.5" cy="12.5" r="2.5" fill="#0a0a1a"/><circle cx="15.5" cy="12.5" r="2.5" fill="#0a0a1a"/><circle cx="8.5" cy="12.5" r="1.5" fill="#00f5ff"/><circle cx="15.5" cy="12.5" r="1.5" fill="#00f5ff"/><rect x="10" y="16" width="4" height="2" rx="1" fill="#ec4899"/></svg>
                        Ask NOVA
                    </button>
                    <button class="trip-btn" id="tripPlannerBtn" onclick="toggleTripPlanner()">
                        <span id="tripBtnIcon">üìå</span> <span id="tripBtnText">Add to Trip Planner</span>
                    </button>
                </div>

                <!-- Quick Info -->
                <div class="info-card">
                    <h3>üìã Quick Info</h3>
                    <div class="quick-info">
                        <div class="info-item">
                            <span class="info-label">Best Time</span>
                            <span class="info-value" id="bestTime">--</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Avg Budget</span>
                            <span class="info-value" id="avgBudget">--</span>
                        </div>
                    </div>
                </div>

                <!-- Best Months -->
                <div class="info-card">
                    <h3>üìÖ Best Months to Visit</h3>
                    <div class="months-grid" id="monthsGrid">
                        <!-- Loaded dynamically -->
                    </div>
                </div>

                <!-- Country Info -->
                <div class="info-card" id="countryCard">
                    <h3>üåê Country Info</h3>
                    <div style="text-align: center;">
                        <div class="country-flag" id="countryFlag">üè≥Ô∏è</div>
                        <h4 id="countryName">Loading...</h4>
                    </div>
                    <div class="country-details">
                        <div class="country-detail">
                            <span>Capital</span>
                            <span id="countryCapital">--</span>
                        </div>
                        <div class="country-detail">
                            <span>Currency</span>
                            <span id="countryCurrency">--</span>
                        </div>
                        <div class="country-detail">
                            <span>Language</span>
                            <span id="countryLanguage">--</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="page-footer">
            <div class="footer-content">
                <div class="footer-brand">
                    <h3>WhereTo</h3>
                    <p>Your Next Journey Starts Here</p>
                </div>
                <div class="footer-links">
                    <a href="nova.html">NOVA</a>
                    <a href="destinations.html">Destinations</a>
                    <a href="trip-planner.html">Trip Planner</a>
                    <a href="visa-guide.html">Visa Guide</a>
                    <a href="budget-calculator.html">Budget</a>
                    <a href="currency-converter.html">Currency</a>
                </div>
                <div class="footer-bottom">
                    <p>Made with ‚ù§Ô∏è for travelers everywhere</p>
                    <p>¬© 2026 WhereTo. All rights reserved.</p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script src="regions-data.js"></script>
    <script>
        // Get IDs from URL
        const urlParams = new URLSearchParams(window.location.search);
        const cityId = urlParams.get('id');
        const countryId = urlParams.get('country');
        const regionId = urlParams.get('region');

        let currentCity = null;
        let currentCountry = null;
        let currentRegion = null;
        let cityMap = null;
        let mapMarkers = [];
        let landmarksVisible = true;

        // Attraction icons based on type
        const typeIcons = {
            'landmark': 'üèõÔ∏è',
            'museum': 'üñºÔ∏è',
            'palace': 'üè∞',
            'castle': 'üè∞',
            'church': '‚õ™',
            'cathedral': '‚õ™',
            'mosque': 'üïå',
            'religious': 'üïç',
            'temple': 'üõï',
            'monastery': 'üïç',
            'park': 'üå≥',
            'garden': 'üå∑',
            'beach': 'üèñÔ∏è',
            'mountain': '‚õ∞Ô∏è',
            'nature': 'üèûÔ∏è',
            'lake': 'üèûÔ∏è',
            'waterfall': 'üí¶',
            'tower': 'üóº',
            'bridge': 'üåâ',
            'market': 'üõí',
            'square': 'üèõÔ∏è',
            'street': 'üõ§Ô∏è',
            'neighborhood': 'üèòÔ∏è',
            'zoo': 'ü¶Å',
            'aquarium': 'üê†',
            'historic': 'üèõÔ∏è',
            'unesco': 'üåç',
            'viewpoint': 'üëÅÔ∏è',
            'food': 'üçΩÔ∏è',
            'shopping': 'üõçÔ∏è',
            'activity': 'üéØ',
            'experience': '‚ú®',
            'default': 'üìç'
        };

        function getAttractionIcon(type) {
            if (!type) return typeIcons.default;
            const typeLower = type.toLowerCase();
            for (const [keyword, icon] of Object.entries(typeIcons)) {
                if (typeLower.includes(keyword)) {
                    return icon;
                }
            }
            return typeIcons.default;
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            initializePage();
            setupNavToggle();
        });

        function initializePage() {
            if (!cityId || !countryId || !regionId) {
                showError('No city specified');
                return;
            }

            // Get city details using the helper function from regions-data.js
            currentCity = getCityDetails(regionId, countryId, cityId);

            if (!currentCity) {
                showError('City not found');
                return;
            }

            // Get region and country info
            const regions = getAllRegions();
            currentRegion = regions.find(r => r.id === regionId);
            const countries = getCountriesByRegion(regionId);
            currentCountry = countries.find(c => c.id === countryId);

            // Update breadcrumbs and links
            const regionLink = document.getElementById('regionLink');
            regionLink.href = `region.html?id=${regionId}`;
            regionLink.textContent = currentRegion ? currentRegion.name : 'Region';

            const countryLink = document.getElementById('countryLink');
            countryLink.href = `country.html?id=${countryId}&region=${regionId}`;
            countryLink.textContent = currentCountry ? currentCountry.name : 'Country';

            document.getElementById('cityBreadcrumb').textContent = currentCity.name;

            // Update back button
            const backBtn = document.getElementById('backBtn');
            backBtn.href = `country.html?id=${countryId}&region=${regionId}`;
            backBtn.textContent = `‚Üê Back to ${currentCountry ? currentCountry.name : 'Country'}`;

            // Update page title
            document.title = `${currentCity.name}, ${currentCity.country} - WhereTo`;

            // Update hero
            document.getElementById('heroSection').style.backgroundImage = `url('${currentCity.image}')`;
            document.getElementById('cityTitle').textContent = currentCity.name;
            document.getElementById('cityLocation').innerHTML = `üìç ${currentCity.country}`;
            document.getElementById('cityPopulation').innerHTML = `üë• ${currentCity.population}`;

            // Update description
            document.getElementById('cityDescription').textContent = currentCity.description;

            // Update budget info
            if (currentCity.avgBudget && typeof currentCity.avgBudget === 'object') {
                document.getElementById('budgetLow').textContent = `$${currentCity.avgBudget.budget}`;
                document.getElementById('budgetMid').textContent = `$${currentCity.avgBudget.mid}`;
                document.getElementById('budgetLuxury').textContent = `$${currentCity.avgBudget.luxury}`;
                document.getElementById('avgBudget').textContent = `$${currentCity.avgBudget.mid}/day`;
            } else {
                const budget = currentCity.avgBudget || 100;
                document.getElementById('budgetLow').textContent = `$${Math.round(budget * 0.6)}`;
                document.getElementById('budgetMid').textContent = `$${budget}`;
                document.getElementById('budgetLuxury').textContent = `$${Math.round(budget * 2.5)}`;
                document.getElementById('avgBudget').textContent = `$${budget}/day`;
            }

            // Update best time
            document.getElementById('bestTime').textContent = currentCity.bestTime;

            // Load attractions
            loadAttractions(currentCity.attractions);

            // Load tips
            loadTips(currentCity.tips);

            // Load months grid
            loadMonthsGrid();

            // Update country info
            if (currentCountry) {
                document.getElementById('countryFlag').textContent = currentCountry.flag;
                document.getElementById('countryName').textContent = currentCountry.name;
                document.getElementById('countryCapital').textContent = currentCountry.capital || '--';
                document.getElementById('countryCurrency').textContent = currentCountry.currency;
                document.getElementById('countryLanguage').textContent = currentCountry.language;
            }

            // Initialize map
            initCityMap();

            // Update trip planner button state
            updateTripPlannerButton();
        }

        function loadAttractions(attractions) {
            const container = document.getElementById('attractionsList');
            
            if (!attractions || attractions.length === 0) {
                container.innerHTML = '<p style="color: rgba(255,255,255,0.6);">No attractions listed yet.</p>';
                return;
            }

            container.innerHTML = attractions.map((attraction, index) => `
                <div class="attraction-accordion" data-index="${index}">
                    <div class="attraction-header" onclick="toggleAttraction(${index})">
                        <div class="attraction-header-left">
                            <span class="attraction-icon">${getAttractionIcon(attraction.type)}</span>
                            <span class="attraction-title">${attraction.name}</span>
                        </div>
                        <span class="attraction-type">${attraction.type || 'Attraction'}</span>
                        <span class="attraction-toggle">‚ñº</span>
                    </div>
                    <div class="attraction-content">
                        <div class="attraction-details">${attraction.description}</div>
                    </div>
                </div>
            `).join('');
        }

        function toggleAttraction(index) {
            const accordion = document.querySelector(`.attraction-accordion[data-index="${index}"]`);
            if (accordion) {
                accordion.classList.toggle('expanded');
            }
        }

        function loadTips(tips) {
            const container = document.getElementById('tipsList');
            
            if (!tips || tips.length === 0) {
                container.innerHTML = '<p style="color: rgba(255,255,255,0.6);">No tips available yet.</p>';
                return;
            }

            container.innerHTML = tips.map(tip => `
                <div class="tip-item">
                    <p>${tip}</p>
                </div>
            `).join('');
        }

        function loadMonthsGrid() {
            const monthsGrid = document.getElementById('monthsGrid');
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            
            // Parse best time to determine best months
            const bestTime = currentCity.bestTime ? currentCity.bestTime.toLowerCase() : '';
            const bestMonths = [];
            
            const monthMap = {
                'january': 0, 'february': 1, 'march': 2, 'april': 3, 'may': 4, 'june': 5,
                'july': 6, 'august': 7, 'september': 8, 'october': 9, 'november': 10, 'december': 11,
                'jan': 0, 'feb': 1, 'mar': 2, 'apr': 3, 'jun': 5, 'jul': 6, 'aug': 7, 'sep': 8, 'oct': 9, 'nov': 10, 'dec': 11
            };
            
            for (const [name, idx] of Object.entries(monthMap)) {
                if (bestTime.includes(name)) {
                    bestMonths.push(idx);
                }
            }

            monthsGrid.innerHTML = months.map((month, index) => {
                const isBest = bestMonths.includes(index);
                return `<div class="month-tag ${isBest ? 'best' : ''}">${month}</div>`;
            }).join('');
        }

        // ============================================
        // MAP FUNCTIONALITY
        // ============================================
        function initCityMap() {
            // Get coordinates from city name using a simple lookup
            const cityCoords = getCityCoordinates(currentCity.name, currentCity.country);
            
            if (!cityCoords) {
                document.getElementById('cityMapSection').style.display = 'none';
                return;
            }

            // Update map title
            document.getElementById('mapTitle').textContent = `${currentCity.name} Map`;

            // Clear loading state
            const mapContainer = document.getElementById('cityMap');
            mapContainer.innerHTML = '';

            setTimeout(() => {
                cityMap = L.map('cityMap', {
                    center: cityCoords,
                    zoom: 13,
                    zoomControl: true,
                    scrollWheelZoom: true
                });

                // Add OpenStreetMap tiles
                L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',
                    maxZoom: 19
                }).addTo(cityMap);

                // Add city center marker
                const centerMarker = L.marker(cityCoords, {
                    icon: createCustomIcon('üìç', 'city-center-marker')
                }).addTo(cityMap);
                centerMarker.bindPopup(`
                    <div class="marker-popup">
                        <h4>${currentCity.name}</h4>
                        <div class="popup-type">City Center</div>
                    </div>
                `);
                mapMarkers.push(centerMarker);

                // Add attraction markers if we have coordinates
                if (currentCity.attractions && currentCity.attractions.length > 0) {
                    addAttractionMarkers(cityCoords);
                }

                // Update legend
                updateMapLegend();

                setTimeout(() => {
                    cityMap.invalidateSize();
                    cityMap.setView(cityCoords, 13);
                }, 200);
            }, 100);
        }

        function createCustomIcon(emoji, extraClass = '') {
            return L.divIcon({
                html: `<div class="custom-marker ${extraClass}">${emoji}</div>`,
                className: 'custom-div-icon',
                iconSize: [40, 40],
                iconAnchor: [20, 40],
                popupAnchor: [0, -40]
            });
        }

        function addAttractionMarkers(centerCoords) {
            // Get landmark data if available, otherwise place in a spread pattern
            const landmarks = getLandmarkCoordinates(currentCity.name);
            
            if (landmarks && Object.keys(landmarks).length > 0) {
                // Use real landmark coordinates
                currentCity.attractions.forEach((attraction) => {
                    const landmarkCoords = landmarks[attraction.name];
                    if (landmarkCoords) {
                        const marker = L.marker(landmarkCoords, {
                            icon: createCustomIcon(getAttractionIcon(attraction.type))
                        }).addTo(cityMap);
                        
                        marker.bindPopup(`
                            <div class="marker-popup">
                                <h4>${getAttractionIcon(attraction.type)} ${attraction.name}</h4>
                                <div class="popup-type">${attraction.type || 'Attraction'}</div>
                            </div>
                        `);
                        
                        mapMarkers.push(marker);
                    }
                });
            }
            
            // Place remaining attractions in a spread pattern around center
            const placedNames = landmarks ? Object.keys(landmarks) : [];
            const unplacedAttractions = currentCity.attractions.filter(a => !placedNames.includes(a.name));
            
            if (unplacedAttractions.length > 0) {
                // Use varied radii for more natural spread
                const baseRadius = 0.015; // ~1.5km
                unplacedAttractions.forEach((attraction, index) => {
                    const angle = (index / unplacedAttractions.length) * 2 * Math.PI + (Math.random() * 0.3);
                    const radiusVariation = baseRadius * (0.5 + Math.random() * 0.8);
                    const lat = centerCoords[0] + radiusVariation * Math.cos(angle);
                    const lng = centerCoords[1] + radiusVariation * Math.sin(angle) * 1.3;
                    
                    const marker = L.marker([lat, lng], {
                        icon: createCustomIcon(getAttractionIcon(attraction.type))
                    }).addTo(cityMap);
                    
                    marker.bindPopup(`
                        <div class="marker-popup">
                            <h4>${getAttractionIcon(attraction.type)} ${attraction.name}</h4>
                            <div class="popup-type">${attraction.type || 'Attraction'}</div>
                        </div>
                    `);
                    
                    mapMarkers.push(marker);
                });
            }
        }

        // Landmark coordinates for major cities
        function getLandmarkCoordinates(cityName) {
            const landmarks = {
                'Paris': {
                    'Eiffel Tower': [48.8584, 2.2945],
                    'Louvre Museum': [48.8606, 2.3376],
                    'Notre-Dame': [48.8530, 2.3499],
                    'Arc de Triomphe': [48.8738, 2.2950],
                    'Sacr√©-C≈ìur': [48.8867, 2.3431],
                    'Champs-√âlys√©es': [48.8698, 2.3075],
                    'Montmartre': [48.8867, 2.3431]
                },
                'London': {
                    'Big Ben': [51.5007, -0.1246],
                    'Tower of London': [51.5081, -0.0759],
                    'Buckingham Palace': [51.5014, -0.1419],
                    'British Museum': [51.5194, -0.1270],
                    'London Eye': [51.5033, -0.1196],
                    'Tower Bridge': [51.5055, -0.0754],
                    'Westminster Abbey': [51.4994, -0.1273]
                },
                'Rome': {
                    'Colosseum': [41.8902, 12.4922],
                    'Vatican City': [41.9029, 12.4534],
                    'Trevi Fountain': [41.9009, 12.4833],
                    'Pantheon': [41.8986, 12.4769],
                    'Roman Forum': [41.8925, 12.4853],
                    'Spanish Steps': [41.9060, 12.4828],
                    'St. Peter\'s Basilica': [41.9022, 12.4539]
                },
                'Tokyo': {
                    'Shibuya Crossing': [35.6595, 139.7004],
                    'Senso-ji Temple': [35.7148, 139.7967],
                    'Tokyo Tower': [35.6586, 139.7454],
                    'Meiji Shrine': [35.6764, 139.6993],
                    'Tokyo Skytree': [35.7101, 139.8107],
                    'Imperial Palace': [35.6852, 139.7528],
                    'Shinjuku': [35.6896, 139.6917]
                },
                'New York': {
                    'Statue of Liberty': [40.6892, -74.0445],
                    'Central Park': [40.7829, -73.9654],
                    'Times Square': [40.7580, -73.9855],
                    'Empire State Building': [40.7484, -73.9857],
                    'Brooklyn Bridge': [40.7061, -73.9969],
                    'One World Trade Center': [40.7127, -74.0134]
                },
                'Dubai': {
                    'Burj Khalifa': [25.1972, 55.2744],
                    'Palm Jumeirah': [25.1124, 55.1390],
                    'Dubai Mall': [25.1985, 55.2796],
                    'Burj Al Arab': [25.1412, 55.1853],
                    'Dubai Marina': [25.0805, 55.1403],
                    'Dubai Frame': [25.2354, 55.3005]
                },
                'Barcelona': {
                    'Sagrada Familia': [41.4036, 2.1744],
                    'Park G√ºell': [41.4145, 2.1527],
                    'La Rambla': [41.3797, 2.1734],
                    'Casa Batll√≥': [41.3916, 2.1650],
                    'Gothic Quarter': [41.3833, 2.1761],
                    'Camp Nou': [41.3809, 2.1228]
                },
                'Amsterdam': {
                    'Anne Frank House': [52.3752, 4.8840],
                    'Rijksmuseum': [52.3600, 4.8852],
                    'Van Gogh Museum': [52.3584, 4.8811],
                    'Dam Square': [52.3731, 4.8932],
                    'Canal Ring': [52.3676, 4.9041],
                    'Vondelpark': [52.3579, 4.8686]
                },
                'Vienna': {
                    'Sch√∂nbrunn Palace': [48.1845, 16.3122],
                    'St. Stephen\'s Cathedral': [48.2082, 16.3738],
                    'Belvedere Palace': [48.1914, 16.3805],
                    'Hofburg Palace': [48.2064, 16.3649],
                    'Vienna State Opera': [48.2034, 16.3689]
                },
                'Singapore': {
                    'Marina Bay Sands': [1.2834, 103.8607],
                    'Gardens by the Bay': [1.2816, 103.8636],
                    'Sentosa Island': [1.2494, 103.8303],
                    'Orchard Road': [1.3048, 103.8318],
                    'Merlion Park': [1.2868, 103.8545],
                    'Chinatown': [1.2839, 103.8443]
                },
                'Bangkok': {
                    'Grand Palace': [13.7500, 100.4914],
                    'Wat Pho': [13.7465, 100.4927],
                    'Wat Arun': [13.7437, 100.4888],
                    'Chatuchak Market': [13.7999, 100.5506],
                    'Khao San Road': [13.7582, 100.4971]
                },
                'Istanbul': {
                    'Hagia Sophia': [41.0086, 28.9802],
                    'Blue Mosque': [41.0054, 28.9768],
                    'Topkapi Palace': [41.0115, 28.9833],
                    'Grand Bazaar': [41.0106, 28.9680],
                    'Galata Tower': [41.0256, 28.9741],
                    'Bosphorus': [41.0411, 29.0083]
                },
                'Sydney': {
                    'Sydney Opera House': [-33.8568, 151.2153],
                    'Sydney Harbour Bridge': [-33.8523, 151.2108],
                    'Bondi Beach': [-33.8915, 151.2767],
                    'Darling Harbour': [-33.8723, 151.1987],
                    'The Rocks': [-33.8590, 151.2085]
                },
                'Prague': {
                    'Charles Bridge': [50.0865, 14.4114],
                    'Prague Castle': [50.0911, 14.4017],
                    'Old Town Square': [50.0875, 14.4213],
                    'Astronomical Clock': [50.0870, 14.4206],
                    'St. Vitus Cathedral': [50.0909, 14.4006]
                }
            };
            return landmarks[cityName] || null;
        }

        function updateMapLegend() {
            const legendItems = document.getElementById('legendItems');
            
            if (!currentCity.attractions || currentCity.attractions.length === 0) {
                legendItems.innerHTML = `
                    <div class="legend-item">
                        <span class="legend-icon">üìç</span>
                        <span>City Center</span>
                    </div>
                `;
                return;
            }

            // Get unique types
            const types = [...new Set(currentCity.attractions.map(a => a.type).filter(Boolean))];
            
            let html = `
                <div class="legend-item">
                    <span class="legend-icon">üìç</span>
                    <span>City Center</span>
                </div>
            `;
            
            types.slice(0, 6).forEach(type => {
                html += `
                    <div class="legend-item">
                        <span class="legend-icon">${getAttractionIcon(type)}</span>
                        <span>${type}</span>
                    </div>
                `;
            });
            
            legendItems.innerHTML = html;
        }

        function resetMapView() {
            if (cityMap && currentCity) {
                const coords = getCityCoordinates(currentCity.name, currentCity.country);
                if (coords) {
                    cityMap.setView(coords, 13);
                }
            }
        }

        function toggleLandmarks() {
            landmarksVisible = !landmarksVisible;
            const btn = document.getElementById('toggleLandmarksBtn');
            
            mapMarkers.forEach((marker, index) => {
                if (index === 0) return; // Skip city center
                
                if (landmarksVisible) {
                    marker.addTo(cityMap);
                } else {
                    cityMap.removeLayer(marker);
                }
            });
            
            btn.innerHTML = landmarksVisible ? 'üìç Landmarks' : 'üìç Show All';
            btn.style.opacity = landmarksVisible ? '1' : '0.6';
        }

        // City coordinates lookup (comprehensive list)
        function getCityCoordinates(cityName, country) {
            const coords = {
                // Europe
                'Paris': [48.8566, 2.3522],
                'London': [51.5074, -0.1278],
                'Rome': [41.9028, 12.4964],
                'Barcelona': [41.3851, 2.1734],
                'Amsterdam': [52.3676, 4.9041],
                'Vienna': [48.2082, 16.3738],
                'Prague': [50.0755, 14.4378],
                'Berlin': [52.5200, 13.4050],
                'Madrid': [40.4168, -3.7038],
                'Venice': [45.4408, 12.3155],
                'Florence': [43.7696, 11.2558],
                'Milan': [45.4642, 9.1900],
                'Athens': [37.9838, 23.7275],
                'Lisbon': [38.7223, -9.1393],
                'Dublin': [53.3498, -6.2603],
                'Edinburgh': [55.9533, -3.1883],
                'Brussels': [50.8503, 4.3517],
                'Copenhagen': [55.6761, 12.5683],
                'Stockholm': [59.3293, 18.0686],
                'Oslo': [59.9139, 10.7522],
                'Helsinki': [60.1699, 24.9384],
                'Warsaw': [52.2297, 21.0122],
                'Budapest': [47.4979, 19.0402],
                'Zurich': [47.3769, 8.5417],
                'Geneva': [46.2044, 6.1432],
                'Munich': [48.1351, 11.5820],
                'Tirana': [41.3275, 19.8189],
                'Salzburg': [47.8095, 13.0550],
                'Split': [43.5081, 16.4402],
                'Dubrovnik': [42.6507, 18.0944],
                'Lyon': [45.7640, 4.8357],
                'Nice': [43.7102, 7.2620],
                'Bordeaux': [44.8378, -0.5792],
                'Hamburg': [53.5511, 9.9937],
                'Cologne': [50.9375, 6.9603],
                'Santorini': [36.3932, 25.4615],
                'Crete': [35.2401, 24.8093],
                'Reykjavik': [64.1466, -21.9426],
                'Krakow': [50.0647, 19.9450],
                'Porto': [41.1579, -8.6291],
                'Seville': [37.3891, -5.9845],
                'Lucerne': [47.0502, 8.3093],
                'Manchester': [53.4808, -2.2426],
                'Liverpool': [53.4084, -2.9916],
                'Monaco': [43.7384, 7.4246],
                'Cannes': [43.5528, 7.0174],
                'Naples': [40.8518, 14.2681],
                'Amalfi': [40.6340, 14.6027],
                'Verona': [45.4384, 10.9916],
                'Cinque Terre': [44.1461, 9.6439],
                'Granada': [37.1773, -3.5986],
                'Valencia': [39.4699, -0.3763],
                'Bruges': [51.2093, 3.2247],
                'Ghent': [51.0543, 3.7174],
                'Rotterdam': [51.9244, 4.4777],
                'The Hague': [52.0705, 4.3007],
                'Innsbruck': [47.2692, 11.4041],
                'Hallstatt': [47.5622, 13.6493],
                'Interlaken': [46.6863, 7.8632],
                'Zermatt': [46.0207, 7.7491],
                'Bergen': [60.3913, 5.3221],
                'Gothenburg': [57.7089, 11.9746],
                'Malmo': [55.6050, 13.0038],
                'Tallinn': [59.4370, 24.7536],
                'Riga': [56.9496, 24.1052],
                'Vilnius': [54.6872, 25.2797],
                'Ljubljana': [46.0569, 14.5058],
                'Zagreb': [45.8150, 15.9819],
                'Belgrade': [44.7866, 20.4489],
                'Sarajevo': [43.8563, 18.4131],
                'Bucharest': [44.4268, 26.1025],
                'Sofia': [42.6977, 23.3219],
                'Bratislava': [48.1486, 17.1077],
                'Ljubljana': [46.0569, 14.5058],
                // Asia
                'Tokyo': [35.6762, 139.6503],
                'Kyoto': [35.0116, 135.7681],
                'Osaka': [34.6937, 135.5023],
                'Singapore': [1.3521, 103.8198],
                'Bangkok': [13.7563, 100.5018],
                'Hong Kong': [22.3193, 114.1694],
                'Seoul': [37.5665, 126.9780],
                'Beijing': [39.9042, 116.4074],
                'Shanghai': [31.2304, 121.4737],
                'Taipei': [25.0330, 121.5654],
                'Kuala Lumpur': [3.1390, 101.6869],
                'Jakarta': [-6.2088, 106.8456],
                'Manila': [14.5995, 120.9842],
                'Hanoi': [21.0285, 105.8542],
                'Ho Chi Minh City': [10.8231, 106.6297],
                'Bali': [-8.3405, 115.0920],
                'Phuket': [7.8804, 98.3923],
                'Chiang Mai': [18.7883, 98.9853],
                'Mumbai': [19.0760, 72.8777],
                'Delhi': [28.7041, 77.1025],
                'New Delhi': [28.6139, 77.2090],
                'Jaipur': [26.9124, 75.7873],
                'Agra': [27.1767, 78.0081],
                'Goa': [15.2993, 74.1240],
                'Colombo': [6.9271, 79.8612],
                'Kathmandu': [27.7172, 85.3240],
                'Hiroshima': [34.3853, 132.4553],
                'Nara': [34.6851, 135.8048],
                'Sapporo': [43.0618, 141.3545],
                'Busan': [35.1796, 129.0756],
                'Jeju': [33.4996, 126.5312],
                'Xi\'an': [34.3416, 108.9398],
                'Guilin': [25.2736, 110.2901],
                'Siem Reap': [13.3633, 103.8600],
                'Luang Prabang': [19.8850, 102.1347],
                'Yogyakarta': [-7.7956, 110.3695],
                'Penang': [5.4141, 100.3288],
                'Langkawi': [6.3500, 99.8000],
                'Cebu': [10.3157, 123.8854],
                'Boracay': [11.9674, 121.9248],
                'El Nido': [11.1930, 119.3960],
                'Hoi An': [15.8801, 108.3380],
                'Da Nang': [16.0544, 108.2022],
                'Halong Bay': [20.9101, 107.1839],
                'Kandy': [7.2906, 80.6337],
                'Galle': [6.0535, 80.2210],
                'Ella': [6.8667, 81.0466],
                // Middle East
                'Dubai': [25.2048, 55.2708],
                'Abu Dhabi': [24.4539, 54.3773],
                'Istanbul': [41.0082, 28.9784],
                'Jerusalem': [31.7683, 35.2137],
                'Tel Aviv': [32.0853, 34.7818],
                'Petra': [30.3285, 35.4444],
                'Amman': [31.9454, 35.9284],
                'Mecca': [21.3891, 39.8579],
                'Medina': [24.5247, 39.5692],
                'Riyadh': [24.7136, 46.6753],
                'Jeddah': [21.4858, 39.1925],
                'Doha': [25.2854, 51.5310],
                'Muscat': [23.5880, 58.3829],
                'Cairo': [30.0444, 31.2357],
                'Marrakech': [31.6295, -7.9811],
                'Fes': [34.0181, -5.0078],
                'Casablanca': [33.5731, -7.5898],
                // Africa
                'Cape Town': [-33.9249, 18.4241],
                'Johannesburg': [-26.2041, 28.0473],
                'Nairobi': [-1.2921, 36.8219],
                'Zanzibar': [-6.1659, 39.2026],
                'Victoria Falls': [-17.9243, 25.8572],
                'Luxor': [25.6872, 32.6396],
                'Tunis': [36.8065, 10.1815],
                'Accra': [5.6037, -0.1870],
                'Lagos': [6.5244, 3.3792],
                'Addis Ababa': [-9.0320, 38.7469],
                // Americas
                'New York': [40.7128, -74.0060],
                'Los Angeles': [34.0522, -118.2437],
                'San Francisco': [37.7749, -122.4194],
                'Miami': [25.7617, -80.1918],
                'Las Vegas': [36.1699, -115.1398],
                'Chicago': [41.8781, -87.6298],
                'Toronto': [43.6532, -79.3832],
                'Vancouver': [49.2827, -123.1207],
                'Montreal': [45.5017, -73.5673],
                'Mexico City': [19.4326, -99.1332],
                'Cancun': [21.1619, -86.8515],
                'Havana': [23.1136, -82.3666],
                'Rio de Janeiro': [-22.9068, -43.1729],
                'Buenos Aires': [-34.6037, -58.3816],
                'Lima': [-12.0464, -77.0428],
                'Cusco': [-13.5319, -71.9675],
                'Machu Picchu': [-13.1631, -72.5450],
                'Bogota': [4.7110, -74.0721],
                'Cartagena': [10.3910, -75.4794],
                'Santiago': [-33.4489, -70.6693],
                'San Jose': [9.9281, -84.0907],
                // Oceania
                'Sydney': [-33.8688, 151.2093],
                'Melbourne': [-37.8136, 144.9631],
                'Brisbane': [-27.4705, 153.0260],
                'Perth': [-31.9505, 115.8605],
                'Auckland': [-36.8509, 174.7645],
                'Queenstown': [-45.0312, 168.6626],
                'Fiji': [-17.7134, 178.0650],
                'Bora Bora': [-16.5004, -151.7415],
                'Maldives': [3.2028, 73.2207],
                'Cairns': [-16.9186, 145.7781],
                'Gold Coast': [-28.0167, 153.4000],
                'Wellington': [-41.2865, 174.7762],
                'Rotorua': [-38.1368, 176.2497],
                'Tahiti': [-17.6509, -149.4260]
            };
            
            return coords[cityName] || null;
        }

        // ============================================
        // TRIP PLANNER FUNCTIONALITY
        // ============================================
        function isInTripPlanner() {
            const saved = JSON.parse(localStorage.getItem('tripPlanner') || '[]');
            const tripId = `city_${regionId}_${countryId}_${cityId}`;
            return saved.some(d => d.tripId === tripId);
        }

        function updateTripPlannerButton() {
            const btn = document.getElementById('tripPlannerBtn');
            const icon = document.getElementById('tripBtnIcon');
            const text = document.getElementById('tripBtnText');
            
            if (isInTripPlanner()) {
                btn.classList.add('saved');
                icon.textContent = '‚úì';
                text.textContent = 'Added to Trip Planner';
            } else {
                btn.classList.remove('saved');
                icon.textContent = 'üìå';
                text.textContent = 'Add to Trip Planner';
            }
        }

        function toggleTripPlanner() {
            let saved = JSON.parse(localStorage.getItem('tripPlanner') || '[]');
            const tripId = `city_${regionId}_${countryId}_${cityId}`;
            
            if (isInTripPlanner()) {
                saved = saved.filter(d => d.tripId !== tripId);
                localStorage.setItem('tripPlanner', JSON.stringify(saved));
                updateTripPlannerButton();
            } else {
                const tripData = {
                    tripId: tripId,
                    id: currentCity.id,
                    name: currentCity.name,
                    country: currentCity.country,
                    region: currentCity.region,
                    image: currentCity.image,
                    bestTime: currentCity.bestTime,
                    avgBudget: typeof currentCity.avgBudget === 'object' ? currentCity.avgBudget.mid : currentCity.avgBudget,
                    attractions: currentCity.attractions,
                    tips: currentCity.tips,
                    type: 'city',
                    addedAt: new Date().toISOString()
                };
                saved.push(tripData);
                localStorage.setItem('tripPlanner', JSON.stringify(saved));
                updateTripPlannerButton();
                showTripPlannerToast();
            }
        }

        function showTripPlannerToast() {
            const toast = document.createElement('div');
            toast.className = 'trip-toast';
            toast.innerHTML = `
                <span>‚úì Added to Trip Planner</span>
                <a href="trip-planner.html">View Trip ‚Üí</a>
            `;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function askNova() {
            window.location.href = `nova.html?ask=${encodeURIComponent(`Tell me more about ${currentCity.name}, ${currentCity.country}`)}`;
        }

        function showError(message) {
            document.getElementById('cityTitle').textContent = message;
            document.getElementById('cityDescription').textContent = 'Please go back and select a valid city.';
            document.getElementById('attractionsList').innerHTML = '';
            document.getElementById('tipsList').innerHTML = '';
        }

        function setupNavToggle() {
            const navToggle = document.getElementById('navToggle');
            const navLinks = document.querySelector('.nav-links');
            
            if (navToggle) {
                navToggle.addEventListener('click', function() {
                    navLinks.classList.toggle('active');
                    navToggle.textContent = navLinks.classList.contains('active') ? '‚úï' : '‚ò∞';
                });
            }
        }
    </script>
</body>
</html>
